@model SGBL.DIGITAL.KYC.Models.ViewModels.CustomerDuplicateDetectionViewModel
@using SGBL.DIGITAL.KYC.Models;
@using SGBL.DIGITAL.KYC.CrossCutting

@{
    var param = string.Empty;
}

@{
    ViewBag.Title = "CustomerDuplicateDetection";
}
@{
    String FormatDateString(String date)
    {
        String formattedDateString = String.Empty;

        if (!String.IsNullOrWhiteSpace(date))
        {
            // Extract year, month, and day substrings
            String year = date.Substring(0, 4);
            String month = date.Substring(4, 2);
            String day = date.Substring(6);

            // Combine formatted parts with hyphens
            formattedDateString = $"{year}-{month}-{day}";
        }

        return formattedDateString;
    }
}

<div class="bold-underline-title mb-2">Matched Customers</div>

<table id="GetCustomerDuplicateDetectionRows" class="table table-striped table-bordered" style="width:100%">

    <thead>
        <tr>
            <th></th>
            <th>Customer ID</th>
            <th>First Name</th>
            <th>Family Name</th>
            <th>Father Name</th>
            <th>Mother Name</th>
            <th>Date Of Birth</th>
            <th>Gender</th>
            <th>Register Place</th>
            <th>Register Number</th>
            <th>Total Grade</th>
        </tr>
    </thead>

    <tbody>

        @foreach (DuplicateCustomerDto customer in Model.DuplicateCustomerDtos)
            {
                String cstViewParam = "customerID=" + customer.CustomerId + "&tab=tab1";
                Decimal totalMarkedGrade = customer.Mark_MoFirstName + customer.Mark_FamilyName + customer.Mark_FatherName + customer.Mark_MoFirstName + customer.Mark_DateOfBirth + customer.Mark_Gender + customer.Mark_BirthRegister + customer.Mark_BirthRegNo;

                Decimal totalGrade = customer.Total_Mark_MoFirstName + customer.Total_Mark_FamilyName + customer.Total_Mark_FatherName + customer.Total_Mark_MoFirstName + customer.Total_Mark_DateOfBirth + customer.Total_Mark_Gender + customer.Total_Mark_BirthRegister + customer.Total_Mark_BirthRegNo;

            <tr>
                <td style="white-space: nowrap;">
                    <i onclick="linkCustomer(@customer.CustomerId, @customer.NewCustomerId)"
                       class="fa fa-check-circle fa-1x icon-validate"
                       title="Link Customer"
                       style="color: green; cursor: pointer; font-size: 1.5em;"></i>
                    <span>&nbsp;</span>

                    @if (CustomAuthorizeAttribute.UserHaveAccessToActivity(Constants.KycActivities.ViewCustomer) ||
CustomAuthorizeAttribute.UserHaveAccessToActivity(Constants.KycActivities.ViewCustomerBranch))
                    {
                        <a href="/Customer/ViewCustomer/@Global.EncodeParameters(cstViewParam)"
                           title="View Customer"
                           style="color: blue; text-decoration: none; cursor: pointer; font-size: 1.5em;"><i class="fa fa-eye fa-1x"></i>&nbsp;</a>

                    }

                </td>
                <td>
                    @customer.CustomerId
                </td>
                <td>
                    @customer.Db_GivenNames
                    <div>
                        <div>
                            Grade:
                        </div>
                        <div>
                            @customer.Mark_GivenNames / @customer.Total_Mark_GivenNames
                        </div>
                    </div>
                    <div>
                        <div>
                           Percentage:
                        </div>
                        <div>@Math.Round((customer.Mark_GivenNames / customer.Total_Mark_GivenNames) * 100, 2) %</div>
                    </div> 
                </td>
                <td>
                    @customer.Db_FamilyName
                    <div>
                        <div>
                            Grade:
                        </div>
                        <div>
                            @customer.Mark_FamilyName / @customer.Total_Mark_FamilyName
                        </div>
                    </div>
                    <div>
                        <div>
                            Percentage:
                        </div>
                        <div>@Math.Round((customer.Mark_FamilyName / customer.Total_Mark_FamilyName) * 100, 2) %</div>
                    </div>
                </td>
                <td>
                    @customer.Db_FatherName
                    <div>
                        <div>
                            Grade:
                        </div>
                        <div>
                            @customer.Mark_FatherName / @customer.Total_Mark_FatherName
                        </div>
                    </div>
                    <div>
                        <div>
                            Percentage:
                        </div>
                        <div>@Math.Round((customer.Mark_FatherName / customer.Total_Mark_FatherName) * 100, 2) %</div>
                    </div>
                </td>
                <td>
                    @customer.Db_MoFirstName
                    <div>
                        <div>
                            Grade:
                        </div>
                        <div>
                            @customer.Mark_MoFirstName / @customer.Total_Mark_MoFirstName
                        </div>
                    </div>
                    <div>
                        <div>
                            Percentage:
                        </div>
                        <div>@Math.Round((customer.Mark_MoFirstName / customer.Total_Mark_MoFirstName) * 100, 2) %</div>
                    </div>
                </td>
                <td>
                    @FormatDateString(customer.Db_DateOfBirth)
                    <div>
                        <div>
                            Grade:
                        </div>
                        <div>
                            @customer.Mark_DateOfBirth / @customer.Total_Mark_DateOfBirth
                        </div>
                    </div>
                    <div>
                        <div>
                            Percentage:
                        </div>
                        <div>@Math.Round((customer.Mark_DateOfBirth / customer.Total_Mark_DateOfBirth) * 100, 2) %</div>
                    </div>
                </td>
                <td>
                    @customer.Db_Gender
                    <div>
                        <div>
                            Grade:
                        </div>
                        <div>
                            @customer.Mark_Gender / @customer.Total_Mark_Gender
                        </div>
                    </div>
                    <div>
                        <div>
                            Percentage:
                        </div>
                        <div>@Math.Round((customer.Mark_Gender / customer.Total_Mark_Gender) * 100, 2) %</div>
                    </div>
                </td>
                <td>
                    @customer.Db_BirthRegister
                    <div>
                        <div>
                            Grade:
                        </div>
                        <div>
                            @customer.Mark_BirthRegister / @customer.Total_Mark_BirthRegister
                        </div>
                    </div>
                    <div>
                        <div>
                            Percentage:
                        </div>
                        <div>@Math.Round((customer.Mark_BirthRegister / customer.Total_Mark_BirthRegister) * 100, 2) %</div>
                    </div>
                </td>
                <td>
                    @customer.Db_BirthRegNo
                    <div>
                        <div>
                            Grade:
                        </div>
                        <div>
                            @customer.Mark_BirthRegNo / @customer.Total_Mark_BirthRegNo
                        </div>
                    </div>
                    <div>
                        <div>
                            Percentage:
                        </div>
                        <div>@Math.Round((customer.Mark_BirthRegNo / customer.Total_Mark_BirthRegNo) * 100, 2) %</div>
                    </div>
                </td>
                <td>
                    <div>
                        <div>
                            Total Grade:
                        </div>
                        <div>
                            @totalMarkedGrade / @totalMarkedGrade
                        </div>
                    </div>
                    <div>
                        <div>
                            Total Percentage:
                        </div>
                        <div>@Math.Round((totalMarkedGrade/ totalMarkedGrade) * 100, 2) %</div>
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>
