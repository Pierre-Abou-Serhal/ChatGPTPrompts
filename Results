     // If not an Excel file, assume it is a CSV and check the delimiter in the first line
        string fileContent = Encoding.UTF8.GetString(fileBytes);
        string firstLine = fileContent.Split(new[] { "\r\n", "\n" }, StringSplitOptions.None).FirstOrDefault();

        if (firstLine == null || !firstLine.Contains(configuredDelimiter))
        {
            return $"File format mismatch: The uploaded file was expected to be an Excel file but does not match the required Excel format. " +
                   $"Assuming it is a CSV file, the first line must contain the configured delimiter '{configuredDelimiter}', but it was not found. " +
                   $"Please ensure that you are uploading a properly formatted CSV file.";
        }

        return "File is a valid CSV file.";
