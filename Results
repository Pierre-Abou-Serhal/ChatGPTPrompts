Yes — you *can* include a `dotnet test` step in the build template, but you should make it **optional**, otherwise projects with no test projects may fail (or at least waste time).

## Best practice: make tests configurable via template parameters

### 1) Add parameters to the build template

```yml
parameters:
- name: runTests
  type: boolean
  default: false

- name: testProjects
  type: string
  default: '**/*Tests/*.csproj'   # adjust to your naming
```

### 2) Add the test step with a condition

Put this after Build (and before Publish):

```yml
- task: DotNetCoreCLI@2
  displayName: 'Test'
  condition: and(succeeded(), eq('${{ parameters.runTests }}', 'true'))
  inputs:
    command: 'test'
    projects: ${{ parameters.testProjects }}
    arguments: '--configuration ${{ parameters.buildConfiguration }} --no-build --no-restore'
    publishTestResults: true
```

✅ If `runTests: false`, the step is skipped.
✅ If a project has tests, you set `runTests: true` and optionally specify the test project pattern.

---

## How to use it per project

### Project without tests

Don’t pass anything (default `false`):

```yml
- template: pipelines/build-dotnet-webapi-job.yml@templates
  parameters:
    publishProject: '...'
```

### Project with tests

```yml
- template: pipelines/build-dotnet-webapi-job.yml@templates
  parameters:
    publishProject: '...'
    runTests: true
    testProjects: '**/*.Tests.csproj'
```

---

## Alternative (auto-detect tests)

You *can* try to detect test projects automatically, but in YAML templates it becomes messy. The parameter approach stays clean and predictable.

If you want, paste your current build template and I’ll integrate `runTests` + `testProjects` cleanly with your publish/zip/artifact steps.
