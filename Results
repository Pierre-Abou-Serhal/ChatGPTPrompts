case FileType.EXCEL:
                {
                    Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);

                    using MemoryStream excelMemoryStream = new MemoryStream(fileBytes);
                    
                    ExcelReaderConfiguration? excelReaderConfiguration = null;

                    if (!String.IsNullOrWhiteSpace(req.FileInfo.ExcelPassword))
                    {
                        excelReaderConfiguration =  new ()
                        {
                            Password = req.FileInfo.ExcelPassword
                        };
                    }
                    
                    using IExcelDataReader? reader = ExcelReaderFactory.CreateReader(excelMemoryStream, excelReaderConfiguration);
                    
                    DataSet? result = reader.AsDataSet(new ExcelDataSetConfiguration
                    {
                        ConfigureDataTable = (_) => new ExcelDataTableConfiguration
                        {
                            UseHeaderRow = false // Read raw data first
                        }
                    });

                    Int32 sheetNumber = 0;

                    if (req.FileInfo.SheetNumber is not null && req.FileInfo.SheetNumber > 0)
                    {
                        if (req.FileInfo.SheetNumber.Value > result.Tables.Count)
                        {
                            throw new SGBLBadRequestException($"Excel file does not contain the passed sheet number: {req.FileInfo.SheetNumber.Value}.");
                        }
            
                        sheetNumber = req.FileInfo.SheetNumber.Value - 1;
                    }
        
                    DataTable table = result.Tables[sheetNumber];

                    // Parsed Data List that will be returned to client
                    List<ParsedData> parsedDataList = [];

                    foreach (Column column in req.FileInfo.Columns)
                    {
                        List<Int32> injestFilePropertyIds = [];
                        List<ColumnData> columnData = [];
                        Int32 headerNameColumnIndex = -1;

                        ParsedData parsedData = new();
                        parsedData.ColumnIndex = column.ColumnNumber;

                        // Read End Condition Variables
                        Int32 whiteLineCount = 0;

                        // Extracting Header Data
                        if (req.FileInfo.ValidateHeader)
                        {
                            if (req.FileInfo.HeaderRowNumber >= table.Rows.Count)
                            {
                                throw new SGBLBadRequestException($"Invalid Header Row Number. Excel Contains {table.Rows.Count} and Configured Header Row Number: {req.FileInfo.HeaderRowNumber}");
                            }
                            
                            List<String> rowValues = table.Rows[req.FileInfo.HeaderRowNumber - 1].ItemArray.Select(cell => cell?.ToString()?.Trim() ?? String.Empty).ToList();
                            
                            for (Int32 i = 0; i < rowValues.Count; i++)
                            {
                                String cell = rowValues[i];

                                if (cell.Equals(column.HeaderColumnName))
                                {
                                    headerNameColumnIndex = i;
                                    parsedData.ColumnName = column.HeaderColumnName; // Header Name Was Found
                                }

                                headerList.Add(cell);
                            }

                            // Check if header contains the values in "ValidateHeaderContainsFields" array
                            OnCheckHeaderEvent?.Invoke(headerList,
                                req.FileInfo.ValidateHeaderContainsFields, ref res);

                            // Header did not pass checking event
                            if (res.WebResp.Errors.Count > 0)
                            {
                                throw new SGBLBadRequestException("Invalid Header Fields");
                            }
                            
                        }
                        
                        foreach (DataRow row in table.Rows)
                        {
                            Int32 rowNumber = table.Rows.IndexOf(row) + 1; // IndexOf(row) is zero based

                            // Checking if End Condition is reached
                            List<String> rowValues = row.ItemArray
                                .Select(cell => cell?.ToString()?.Trim() ?? String.Empty).ToList();

                            if (CustomCodes.IsReadEndConditionReached(
                                    column.ReadEndCondition,
                                    rowValues,
                                    whiteLineCount,
                                    rowNumber,
                                    column.ReadEndConditionValue))
                            {
                                break;
                            }
                            
                            // Extracting Row Data
                            if (rowNumber < column.StartRowNumber)
                            {
                                continue;
                            }

                            // Checking if a value in a row match any skip string value
                            Boolean skipRow = false;

                            foreach (SkipRowString skipRowString in req.FileInfo.SkipRowStrings)
                            {
                                foreach (var cell in rowValues)
                                {
                                    if (skipRowString.IsRegExp)
                                    {
                                        if (Regex.IsMatch(cell, skipRowString.SkipString))
                                        {
                                            skipRow = true;
                                            break;
                                        }
                                    }
                                    else
                                    {
                                        if (cell.Contains(skipRowString.SkipString))
                                        {
                                            skipRow = true;
                                            break;
                                        }
                                    }
                                }
                            }

                            if (skipRow)
                            {
                                continue;
                            }

                            String cellValue = column.FindFromHeader
                                ? row[headerNameColumnIndex]?.ToString() ?? String.Empty
                                : row[column.ColumnNumber == 0 ? column.ColumnNumber : column.ColumnNumber - 1]
                                    ?.ToString() ?? String.Empty;

                            injestFilePropertyIds =
                                column.CustomDataValidation.Select(i => i.InjestFilePropertyId).ToList();
                            
                            columnData.Add(new ()
                            {
                                Data = cellValue,
                                RowNumber = rowNumber,
                            });
                            
                            if (rowValues.All(String.IsNullOrWhiteSpace))
                            {
                                whiteLineCount++;
                            }
                        }

                        OnCheckRowsDataEvent?.Invoke(injestFilePropertyIds, columnData, ref res);

                        if (res.WebResp.Errors.Count > 0)
                        {
                            throw new SGBLBadRequestException($"Invalid Column {column.ColumnNumber} Fields");
                        }

                        parsedData.ColumnData = columnData;
                        parsedDataList.Add(parsedData);
                    }

                    res.ParsedDataList = parsedDataList;

                    break;
                }
