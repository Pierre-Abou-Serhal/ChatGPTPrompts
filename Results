public EncryptedPayload GetEncryptedPayload(string content)
    {
        RSA? visaPubKey = new X509Certificate2(Path.Combine(
            AppContext.BaseDirectory, "MLE-Keys", _globalSettings.MLEPublicCertName)).GetRSAPublicKey();
        
        long iat = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();

        var jweHeaders = new Dictionary<string, object>
        {
            { "kid", _globalSettings.MLEKeyId },
            { "iat", iat }
        };

        string token = JWT.Encode(
            content,
            visaPubKey,
            JweAlgorithm.RSA_OAEP_256,
            JweEncryption.A128GCM,
            extraHeaders: jweHeaders);

        return new()
        {
            EncData = token
        };
    }
