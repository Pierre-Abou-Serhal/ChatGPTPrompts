// 1) Instanciation du service
var service = new ExchangeService(ExchangeVersion.Exchange2016)
{
    Url = new Uri(_appSettings.EwsUrl),
    Credentials = new WebCredentials(_appSettings.MailBoxUsername, _appSettings.MailBoxPassword)
};

// 2) Impersonation de l’utilisateur cible
service.ImpersonatedUserId =
    new ImpersonatedUserId(
        ConnectingIdType.SmtpAddress,
        "target@domaine.com"
    );

// 3) Récupération de tous les dossiers de la boîte
var root = new FolderId(WellKnownFolderName.MsgFolderRoot, "target@domaine.com");
var folderView = new FolderView(int.MaxValue) { Traversal = FolderTraversal.Deep };
var allFolders = service.FindFolders(root, folderView);

// 4) Parcours et recherche comme dans votre code, en partant de eachFolder.Id